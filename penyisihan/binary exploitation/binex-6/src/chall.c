#include <stdio.h>
#include <stdlib.h>

void win(int param1, int param2) {
    if (param1 == 0xdeadbeef && param2 == 0xcafebabe) {
        // Buka file flag.txt
        FILE *flag_file;
        char flag[100];  // Buffer untuk menyimpan isi file flag.txt

        flag_file = fopen("flag.txt", "r");  // Buka file flag.txt dalam mode read (r)
        if (flag_file == NULL) {
            printf("Tidak dapat membuka file flag.txt!\n");
            return;
        }

        // Baca isi file ke dalam buffer dan cetak ke layar
        fgets(flag, sizeof(flag), flag_file);
        printf("FLAG: %s\n", flag);

        // Tutup file setelah selesai
        fclose(flag_file);
    } else {
        printf("Parameter salah! Kamu gagal mendapatkan flag.\n");
    }
}

void foo() {
    char buffer[64];
    printf("Masukkan sesuatu: ");
    gets(buffer);  // Buffer overflow vulnerability!
}

int main() {
    setvbuf(stdout, NULL, _IONBF, 0);
    printf("Selamat datang di program ekplorasi Kediri!\n");
    foo();
    printf("Terima kasih telah menggunakan program kami.\n");
    return 0;
}

